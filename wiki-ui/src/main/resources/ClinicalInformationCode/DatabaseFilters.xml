<?xml version="1.0" encoding="UTF-8"?>
<xwikidoc>
<web>ClinicalInformationCode</web>
<name>DatabaseFilters</name>
<language></language>
<defaultLanguage></defaultLanguage>
<translation>0</translation>
<parent>ClinicalInformationCode.Export</parent>
<creator>xwiki:XWiki.Admin</creator>
<author>xwiki:XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>xwiki:XWiki.Admin</contentAuthor>
<creationDate>1347306702000</creationDate>
<date>1347396195000</date>
<contentUpdateDate>1347396195000</contentUpdateDate>
<version>1.1</version>
<title></title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/2.0</syntaxId>
<hidden>false</hidden>
<content>{{velocity output=false}}
#set ($targetSpace = "$!{request.space}")
#if (!$targetSpace || $targetSpace == 'ClinicalInformationCode')
  #break
#end
#set ($preferencesObject = $xwiki.getDocument("${targetSpace}.WebHome").getObject('ClinicalInformationCode.DBConfigurationClass'))
#if (!$preferencesObject)
  #break
#end
#set ($activeFields = $preferencesObject.getProperty('activeFields').value)
#set ($dateFormat = "MM/dd/yyyy")
##
##
#macro (__filters_dateRange $field_name $dateStart $dateEnd)
(% class="date-range" %)(((
#__filters_dateField ("after: " "${field_name}/after" $dateStart)

#__filters_dateField ("before: " "${field_name}/before" $dateEnd)
)))
#end
##
#macro (__filters_dateField $label $field_name $value)
{{html}}&lt;label&gt;$label &lt;span class="xHint"&gt;(empty means no constraint)&lt;/span&gt;&lt;input class="xwiki-date" type="text" alt="#if($value)#formatdateISO($value)#end" value="$!xwiki.formatDate($value, $definedFormat)" name="${field_name}" title="${dateFormat}" /&gt;&lt;/label&gt;{{/html}}
#end

#macro(__filters_display $cssClass)
(% class="filters $!cssClass" %)
* By **referrer**: {{html clean=false}}&lt;p class="xHint"&gt;(an empty value list means all referrers are considered)&lt;/p&gt;&lt;input type="text" class="suggestUsers" name="doc.creator" value=""/&gt;{{/html}}
* By **creation date**: #__filters_dateRange("doc.creationDate")
#if ($activeFields.contains('date_of_birth'))
  * By **date of birth** of the patient: #__filters_dateRange("date_of_birth")
#end
#if ($activeFields.contains('omim_id'))
  * By **disease**: {{html clean=false}}&lt;p class="xHint"&gt;(an empty value list means all diseases are considered)&lt;/p&gt;&lt;input type="text" class="suggest multi suggestOmim generateCheckboxes" name="omim_id" value=""/&gt;{{/html}}
  ** Filter records presenting {{html}}&lt;label&gt;&lt;input type="radio" name="omim_id/join_mode" value="AND"/&gt;all&lt;/label&gt;{{/html}} {{html}}&lt;label&gt;&lt;input type="radio" name="omim_id/join_mode" value="OR" checked="checked"/&gt;at least one&lt;/label&gt;{{/html}} of the selected diseases.
#end
#if ($activeFields.contains('phenotype'))
  * By **phenotype**: {{html clean=false}}&lt;p class="xHint"&gt;(an empty value list means all phenotypes are considered)&lt;/p&gt;&lt;input type="text" class="suggest multi suggestHpo generateCheckboxes" name="phenotype" value=""/&gt;{{/html}}
  ** Filter records presenting {{html}}&lt;label&gt;&lt;input type="radio" name="phenotype/join_mode" value="AND"/&gt;all&lt;/label&gt;{{/html}} {{html}}&lt;label&gt;&lt;input type="radio" name="phenotype/join_mode" value="OR" checked="checked"/&gt;at least one&lt;/label&gt;{{/html}} of the selected phenotypes.
  ** Filter records {{html}}&lt;label&gt;&lt;input type="radio" name="phenotype_subterms" value="yes" checked="checked"/&gt;with all subcategories of&lt;/label&gt;{{/html}} {{html}}&lt;label&gt;&lt;input type="radio" name="phenotype_subterms" value="no"/&gt;only matching exactly &lt;/label&gt;{{/html}} the selected phenotypes.
#end
#end
{{/velocity}}</content></xwikidoc>
